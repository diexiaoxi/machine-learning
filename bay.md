# 朴素贝叶斯的模型
　　　　
## 原理

首先通過一個簡單的例子來說明朴素贝叶斯的理论。
在我们最近的一个项目中，需要根据农村场景的一些标识对场景进行分类：
e.g.，红十字，基站等
分类：学校，卫生室，基站等

假设分类模型样本为
$$(x_1^{(1)}, x_2^{(1)},\cdots, x_n^{(1)}, y_1), (x_1^{(2)}, x_1^{(2)},\cdots, x_1^{(2)}, y_2),\cdots, (x_1^{(m)}, x_2^{(m)},\cdots, x_n^{(m)}, y_m),$$
即我们有$m$个样本，每个样本有$n$个特征。
假设特征输出有$k$个类别，定义为$C_1,C_2,\cdots,C_k$.

学习步骤如下：
1. 统计先验分布：
$$P(Y=C_k), (k=1,2,...K)$$

2. 统计条件概率分布：
$$P(X1 = x_1|Y = C_k), \cdots, P(X_n = x_n|Y = C_k), k = 1,2,\cdots,K$$

3. 计算联合分布：
$$P(X_1  = x_1, X_2 = x_2, \cdots, X_n = x_n | Y = C_k) = P(X_1 =x _1|Y=C_k)\cdot P(X_2 = x_2 | Y = C_k) \cdot \cdots\cdot P(X_n = x_n|Y = C_k).$$
以上这个其实就用到了朴素贝叶斯模型的假设，即$X$的$n$个维度之间相互独立。
如果真是非常不独立的话，怎么办，我个人感觉还是就尽量不要使用朴素贝叶斯模型了，考虑使用其他的分类方法比较好。因为这样统计量会很大，尤其是当$n$和$k$的值较大时。

4. 给定测试集的一个新样本特征(x_1^{(test)},x_2^{(test)},...x_n^{(test)})，判断类别：计算出所有的K个条件概率$P(Y=C_k|X=X^{(test)})$，然后找出最大的条件概率对应的类别.

$$P(Y = C_ k | X = X^{(test)} = P(X = X^{(test)}| Y = C_k) P(Y = C_k)/P(X = \prod_{i=1}^n P(X_i  = x_i^{(test)| Y = C_k})$$

基于以上四步，即可实现对新测试集的分类。非常简便。
但它有一定的使用限制条件，
　
1） 理论上，朴素贝叶斯模型假设属性之间相互独立，这个假设在实际应用中往往是不成立的，在属性个数比较多或者属性之间相关性较大时，分类效果不好。

2）需要知道先验概率，且先验概率很多时候取决于假设，假设的模型可以有很多种，因此在某些时候会由于假设的先验模型的原因导致预测效果不佳。

3）由于我们是通过先验和数据来决定后验的概率从而决定分类，所以分类决策**一定**存在一定的错误率。

4）对输入数据的表达形式很敏感。
 
