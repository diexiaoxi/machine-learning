## 降维

## 要准确描述向量，首先要确定一组基，然后给出在基所在的各个直线上的投影值，就可以了。

只不过我们经常省略第一步，而默认以(1,0)和(0,1)为基。实际上任何两个线性无关的二维向量都可以成为一组基。

所谓线性无关在二维平面内可以直观认为是两个不在一条直线上的向量。

最后，上述分析同时给矩阵相乘找到了一种物理解释：
两个矩阵相乘的意义是将右边矩阵中的每一列列向量变换到左边矩阵中每一行行向量为基所表示的空间中去。
更抽象的说，一个矩阵可以表示一种线性变换。很多同学在学线性代数时对矩阵相乘的方法感到奇怪，但是如果明白了矩阵相乘的物理意义，其合理性就一目了然了。

## 协方差矩阵及优化目标

上面我们讨论了选择不同的基可以对同样一组数据给出不同的表示，而且如果基的数量少于向量本身的维数，则可以达到降维的效果。
但是我们还没有回答一个最最关键的问题：如何选择基才是最优的。
或者说，如果我们有一组N维向量，现在要将其降到K维（K小于N），那么我们应该如何选择K个基才能最大程度保留原有的信息？

拿一组二维数据举例子，先将它们均值化后，进行降维处理也就是将它们映射到一条直线上。
那么如何选择这个方向（或者说基）才能尽量保留最多的原始信息呢？一种直观的看法是：希望投影后的投影值尽可能分散。

## 而这种分散程度，可以用数学上的方差来表述，即：

$$Var(a) = \frac{1}{m}\sum_{i=1}^{m}(a_i - \mu)^2 $$

于是上面的问题被形式化表述为：寻找一个一维基，使得所有数据变换为这个基上的坐标表示后，**方差值最大**。

对于上面二维降成一维的问题来说，找到那个使得方差最大的方向就可以了。不过对于更高维，还有一个问题需要解决。考虑三维降到二维问题。与之前相同，首先我们希望找到一个方向使得投影后方差最大，这样就完成了第一个方向的选择，继而我们选择第二个投影方向。

## 但当从二维变为多维时应该怎么办

如果我们还是单纯只选择方差最大的方向，很明显，这个方向与第一个方向应该是“几乎重合在一起”，显然这样的维度是没有用的，因此，应该有其他约束条件。从直观上说，让两个字段尽可能表示更多的原始信息，我们是不希望它们之间存在（线性）相关性的，因为相关性意味着两个字段不是完全独立，必然存在重复表示的信息。
数学上可以用两个字段的协方差表示其相关性，由于已经让每个字段均值为0，则：

$$Cov(a,b) = \frac{1}{m}\sum_{i = 1}^{m}a_i b_i$$

可以看到，在字段均值为0的情况下，两个字段的协方差为其内积除以元素数m。

当协方差为0时，表示两个字段完全独立。为了让协方差为0，我们选择第二个基时只能在与第一个基正交的方向上选择，来保证两个基互不相关。


**至此，我们得到了降维问题的优化目标：将一组N维向量降为K维（K大于0，小于N），其目标是选择K个单位（模为1）正交基，使得原始数据变换到这组基上后，各字段两两间协方差为0，而字段的方差则尽可能大（在正交的约束下，取最大的K个方差）。**

## 协方差矩阵

假设我们只有a和b两个字段，那么我们将它们按行组成矩阵X：

$$X  = \begin{pmatrix}
 a_1 & a_2 & \cdots & a_m \\
 b_1 & b_2 & \cdots & a_m
\end{pmatrix} $$

然后进行以下运算：
$$\frac{1}{m}XX^{T} = \begin{pmatrix}
 \frac{1}{m}\sum_{i=1}^{m}a_1^2  & \frac{1}{m}\sum_{i=1}^{m}a_i b_i\\
\frac{1}{m}\sum_{i=1}^{m}a_ib_i & \frac{1}{m}\sum_{i=1}^{m}b_i^2
\end{pmatrix} $$
可以发现，这个矩阵对角线上的两个元素分别是两个字段的方差，而其它元素是a和b的协方差。

根据矩阵相乘的运算法则，这个结论很容易被推广到一般情况：
设我们有$m$个$n$维数据记录，将其按列排成$n$乘$m$的矩阵$X$，设$C =\frac{1}{m}XX^{T} $，则$C$是一个对称矩阵，其对角线分别个各个字段的方差，而第$i$行$j$列和$j$行$i$列元素相同，表示$i$和$j$两个字段的协方差。

## 协方差矩阵对角化

设原始数据矩阵X对应的协方差矩阵为C，而P是一组基按行组成的矩阵，设Y=PX，则Y为X对P做基变换后的数据。设Y的协方差矩阵为D，则

$$
\begin{aligned}
D & = \frac{1}{m}YY^{T}\\
& = \frac{1}{m}(PX)(PX)^T\\
& = \frac{1}{m} PXX^TP^T\\
& = P(\frac{1}{m}XX^{T})P^{T}\\
& = PCP^{T}
\end{aligned}
$$




